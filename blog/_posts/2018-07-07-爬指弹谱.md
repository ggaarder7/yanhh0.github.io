---
title: 批量下载并打包Ellery在微信公众号分享的所有指弹谱
tags: [ python, spider, starred ]
---

缘起：

> 我正好周末要去打印一大堆弹唱谱子 一起打了
>
> 你有别的要打也告诉我
>
> 要不顺便帮你打一点？

然后：

> 这样吧，我分享一个公众号给你，你帮我打印一下指弹里面的曲谱，一共十几首吧。感谢你
>
> [Official Account Contact Card: ElleryGuitarTab]
>
> 内个指弹家里面的所有曲子，到时候给你钱
>
> 或者你帮我打内个公众号里的左边歌曲中的欧美里面的所有歌曲吧
>
> 好像会多一点

看了一下，谱子是图片类型的，一个一个手动收藏得给累死。

到交流群看了一下，也没有打包好的。

正好[我之前做ITRClub的项目时做过微信公众号的爬虫]({{ site.baseurl }}{% post_url 2018-03-10-wx-pa-spider %})，用Selenium操作浏览器内核，也算轻车熟路。

看一下[目录页](https://mp.weixin.qq.com/mp/homepage?__biz=MzUxOTY3NDYzNQ==&hid=4&sn=3f8c985a8fbdac85d0419698317c86d2&scene=18&devicetype=android-23&version=26060736&lang=ja&nettype=WIFI&ascene=7&session_us=gh_d4fdf93430d0&pass_ticket=bvIYobk%2FZ1b0eJZhvZVOvSwr19cg5AbwGZbNEsWZO6%2F3nPkAwFJKc%2BBxtWROOCUz&wx_header=1&scene=1)：

```
<div class="article_list article_list_0">
			
	<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000229&amp;idx=1&amp;sn=dc36b27899892ec61f8bbd9023971b2d&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4ibCmK2Ikthgddjyzuicd8atrcNSjAIic1A2rXBibCcqyWUF2b6DD408blg/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 All Falls Down</h2>
		<p class="desc">Alan Walker ft. Noah Cyrus</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000438&amp;idx=1&amp;sn=f0f7f06e3d74205efe33e737d54949b9&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLP9icPmk4ISsQo2XSwK8sCuEES1iclsliaLSmD7JmRo3wjzY3ucvuVwlCbA/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Alone</h2>
		<p class="desc">Alan Walker</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000752&amp;idx=1&amp;sn=d59233636a3b837371072a5f52c63c56&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykabkXVyjhwPtbdVm3p6SbOMLuHWlpQic75iahdZnNh1u5GQOgNJ5QOazbw/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Boulevard of Broken Dreams - Green Day</h2>
		<p class="desc">AcousticTrench</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000787&amp;idx=1&amp;sn=3ddbbb2fb900aa568fa064bd2d591f9b&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykaJWfevMXJd6pTSINbWMicsXrHicqEngrk2P4agfhOX7GzSd6PDOOkQUYw/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Careless Whisper</h2>
		<p class="desc">AcousticTrench</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000523&amp;idx=1&amp;sn=d08c2babbd6896e01fec08bc206e4c74&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3TcZ0QGOT8Z57wqWNdm2Hx6taqO3huVerF0yAMWIHckuS3Eb8pt7Xlq6g/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Closer - The Chainsmokers ft. Hasley</h2>
		<p class="desc">Andrew Foy 版本</p>
	</div>
</a>

</div>
```

直接用BeautifulSoup爬：
```python
from bs4 import BeautifulSoup
article_list0 = """
<div class="article_list article_list_0">
			
			<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000229&amp;idx=1&amp;sn=dc36b27899892ec61f8bbd9023971b2d&amp;scene=19#wechat_redirect">
				<div class="cover">
					<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4ibCmK2Ikthgddjyzuicd8atrcNSjAIic1A2rXBibCcqyWUF2b6DD408blg/0" alt="">
				</div>
				<div class="cont">
					<h2 class="title js_title">【TAB】 All Falls Down</h2>
					<p class="desc">Alan Walker ft. Noah Cyrus</p>
				</div>
			</a>

...
"""
soup = BeautifulSoup(article_list0, 'html5lib')

def links_extract(soup):
    dat = []
    for i in soup.find_all('a'):
        dat.append([i.h2.string, i['href']])
    return dat

links_extract(soup)
```

Output:

```
[['【TAB】 All Falls Down',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000229&idx=1&sn=dc36b27899892ec61f8bbd9023971b2d&scene=19#wechat_redirect'],
 ['【TAB】 Alone',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000438&idx=1&sn=f0f7f06e3d74205efe33e737d54949b9&scene=19#wechat_redirect'],
 ['【TAB】 Boulevard of Broken Dreams - Green Day',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000752&idx=1&sn=d59233636a3b837371072a5f52c63c56&scene=19#wechat_redirect'],
...
```

如法炮制把剩下的链接都提取出来：

```
[['【TAB】 All Falls Down',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000229&idx=1&sn=dc36b27899892ec61f8bbd9023971b2d&scene=19#wechat_redirect'],
 ['【TAB】 Alone',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000438&idx=1&sn=f0f7f06e3d74205efe33e737d54949b9&scene=19#wechat_redirect'],
 ['【TAB】 Boulevard of Broken Dreams - Green Day',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000752&idx=1&sn=d59233636a3b837371072a5f52c63c56&scene=19#wechat_redirect'],
 ['【TAB】 Careless Whisper',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000787&idx=1&sn=3ddbbb2fb900aa568fa064bd2d591f9b&scene=19#wechat_redirect'],
 ['【TAB】 Closer - The Chainsmokers ft. Hasley',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000523&idx=1&sn=d08c2babbd6896e01fec08bc206e4c74&scene=19#wechat_redirect'],
 ['【TAB】 Counting Stars - OneRepublic',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000767&idx=1&sn=6e721cec49116354b92dcf94d52fc07f&scene=19#wechat_redirect'],
 ['【TAB】 Despacito',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000346&idx=1&sn=6ebf599913be9ae040e57ee8d2e5baa3&scene=19#wechat_redirect'],
 ['【TAB】 Galway Girl',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000325&idx=1&sn=34c0a1a05dce4c95d18d8accb3e14688&scene=19#wechat_redirect'],
 ['【TAB】 Havana',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000047&idx=1&sn=774acde2d65e181e38446858a07701b4&scene=19#wechat_redirect'],
 ['【TAB】 Heathens - Twenty One Pilots',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000781&idx=1&sn=a11618e4c29b96ce5d45782f072dd159&scene=19#wechat_redirect'],
 ["【TAB】I'll be there for you",
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100001047&idx=1&sn=b50e7c617a67d261e093b686547b9d2d&scene=19#wechat_redirect'],
 ['【TAB】 Let Her Go - Passenger',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000628&idx=1&sn=bbcac788be592b154ce641dd1334d0bc&scene=19#wechat_redirect'],
 ['【TAB】 Paradise',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000980&idx=1&sn=d9f4ac078068dd5929b5461d0e28eca0&scene=19#wechat_redirect'],
 ['【TAB】 Pumped Up Kicks',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000507&idx=1&sn=98a041bb50c4d0bc2ef13cf0d0f840cc&scene=19#wechat_redirect'],
 ['【TAB】 Revolution',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000838&idx=1&sn=d4441494d379dc357b90b5a4d0eeb7a2&scene=19#wechat_redirect'],
 ['【TAB】 Revolution - Conny Berghäll',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100001032&idx=1&sn=93539f264069a5c8f2541b1a61be38ec&scene=19#wechat_redirect'],
 ['【TAB】 Say Something',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000416&idx=1&sn=c851215af66b003326eb98d5a231fb5a&scene=19#wechat_redirect'],
 ['【TAB】 Santa Claus Is Coming To Town',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000171&idx=1&sn=2b57e57212e49da184fd4421026f5868&scene=19#wechat_redirect'],
 ['【TAB】 斯卡布罗集市',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100001076&idx=1&sn=d034e59df5fc03a6d755e449dbde4e93&scene=19#wechat_redirect'],
 ['【TAB】 Scared To Be Lonely',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000233&idx=1&sn=3aad7d0f03330ff66c58b245f4518af1&scene=19#wechat_redirect'],
 ['【TAB】 See you again - Wiz Kalifa ft. Charlie Puth',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000760&idx=1&sn=5dfaf1e308715da70a10e91365e414c3&scene=19#wechat_redirect'],
 ['【TAB】 Shape Of You',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000452&idx=1&sn=a27970bed8811af502d492c134acfbf9&scene=19#wechat_redirect'],
 ['【TAB】 Shelter',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000257&idx=1&sn=ea9fae6a37f9f32d7bdea064cc25fa92&scene=19#wechat_redirect'],
 ['【TAB】 Something Just Like This',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000478&idx=1&sn=d8112d2cb407c1c2fb24d5abd0a092f7&scene=19#wechat_redirect'],
 ['【TAB】 Stay',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000820&idx=1&sn=508da6311534392ad68fb6388e1b4867&scene=19#wechat_redirect'],
 ['【TAB】 Stay With Me - Sam Smith',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000421&idx=1&sn=5d48968abcfdc5333a363ca000e49ae6&scene=19#wechat_redirect'],
 ['【TAB】 Thank You',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000247&idx=1&sn=4b85e3f2e0aeb5fe9aaa05525e2e916b&scene=19#wechat_redirect'],
 ['【TAB】 Too Good At Goodbyes',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000316&idx=1&sn=53b569177f7df04e3512f5bc14ed4e9c&scene=19#wechat_redirect']]
```

发现没装webdriver，用apt装一下。真搞不懂为什么firefoxdriver需要装chromium：

```
$ apt-cache search webdriver
chromedriver - web browser - WebDriver support transitional package
chromium-driver - web browser - WebDriver support
python-selenium - Python bindings for Selenium
python3-selenium - Python3 bindings for Selenium
ruby-childprocess - Ruby library for controlling external programs running in the background
firefoxdriver - Firefox WebDriver support
$ su
Password: 
# apt-get install firefoxdriver
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  chromedriver chromium chromium-driver libminizip1 libre2-3 python-selenium
```

接着分析单个乐谱。先把文章内所有图片都导出来：


