---
title: 批量打包下载Ellery在微信公众号分享的所有指弹谱
tags: [ python, spider, starred ]
---

帮同学爬谱子，正好自己也用得着：

```
> 我正好周末要去打印一大堆弹唱谱子 一起打了
> 你有别的要打也告诉我
> 要不顺便帮你打一点？

< 这样吧，我分享一个公众号给你，你帮我打印一下指弹里面的曲谱，一共十几首吧。感谢你
< [Official Account Contact Card: ElleryGuitarTab]
< 内个指弹家里面的所有曲子，到时候给你钱
< 或者你帮我打内个公众号里的左边歌曲中的欧美里面的所有歌曲吧
< 好像会多一点

> 只要欧美吗？
> 我写了个程序 可以自动获取
> 不是手动一个一个下载

< 全都要
< 厉害了
< 你还会写程序
```

看了一下公众号，谱子是图片类型的，一个一个手动下载得累死。到交流群看了一下，也没有打包好的。

正好[我之前做ITRClub的项目时做过微信公众号的爬虫]({{ site.baseurl }}{% post_url 2018-03-10-wx-pa-spider %})，
有爬微信公众号的经验，打算写一个爬虫。

**从[目录页](
https://mp.weixin.qq.com/mp/homepage?__biz=MzUxOTY3NDYzNQ==&hid=4&sn=3f8c985a8fbdac85d0419698317c86d2&scene=18&devicetype=android-23&version=26060736&lang=ja&nettype=WIFI&ascene=7&session_us=gh_d4fdf93430d0&pass_ticket=bvIYobk%2FZ1b0eJZhvZVOvSwr19cg5AbwGZbNEsWZO6%2F3nPkAwFJKc%2BBxtWROOCUz&wx_header=1&scene=1)中提取歌曲**

```
<div class="article_list article_list_0">

	<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000229&amp;idx=1&amp;sn=dc36b27899892ec61f8bbd9023971b2d&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4ibCmK2Ikthgddjyzuicd8atrcNSjAIic1A2rXBibCcqyWUF2b6DD408blg/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 All Falls Down</h2>
		<p class="desc">Alan Walker ft. Noah Cyrus</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000438&amp;idx=1&amp;sn=f0f7f06e3d74205efe33e737d54949b9&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLP9icPmk4ISsQo2XSwK8sCuEES1iclsliaLSmD7JmRo3wjzY3ucvuVwlCbA/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Alone</h2>
		<p class="desc">Alan Walker</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000752&amp;idx=1&amp;sn=d59233636a3b837371072a5f52c63c56&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykabkXVyjhwPtbdVm3p6SbOMLuHWlpQic75iahdZnNh1u5GQOgNJ5QOazbw/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Boulevard of Broken Dreams - Green Day</h2>
		<p class="desc">AcousticTrench</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000787&amp;idx=1&amp;sn=3ddbbb2fb900aa568fa064bd2d591f9b&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykaJWfevMXJd6pTSINbWMicsXrHicqEngrk2P4agfhOX7GzSd6PDOOkQUYw/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Careless Whisper</h2>
		<p class="desc">AcousticTrench</p>
	</div>
</a>

<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000523&amp;idx=1&amp;sn=d08c2babbd6896e01fec08bc206e4c74&amp;scene=19#wechat_redirect">
	<div class="cover">
		<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3TcZ0QGOT8Z57wqWNdm2Hx6taqO3huVerF0yAMWIHckuS3Eb8pt7Xlq6g/0" alt="">
	</div>
	<div class="cont">
		<h2 class="title js_title">【TAB】 Closer - The Chainsmokers ft. Hasley</h2>
		<p class="desc">Andrew Foy 版本</p>
	</div>
</a>

</div>
```

直接用BeautifulSoup处理：
```python
from bs4 import BeautifulSoup
article_list0 = """
<div class="article_list article_list_0">

			<a class="list_item js_post" href="http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&amp;mid=100000229&amp;idx=1&amp;sn=dc36b27899892ec61f8bbd9023971b2d&amp;scene=19#wechat_redirect">
				<div class="cover">
					<img class="img js_img" src="http://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4ibCmK2Ikthgddjyzuicd8atrcNSjAIic1A2rXBibCcqyWUF2b6DD408blg/0" alt="">
				</div>
				<div class="cont">
					<h2 class="title js_title">【TAB】 All Falls Down</h2>
					<p class="desc">Alan Walker ft. Noah Cyrus</p>
				</div>
			</a>

...
"""
soup = BeautifulSoup(article_list0, 'html5lib')

def links_extract(soup):
    dat = []
    for i in soup.find_all('a'):
        dat.append([i.h2.string, i['href']])
    return dat

links_extract(soup)
```

```
[['【TAB】 All Falls Down',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000229&idx=1&sn=dc36b27899892ec61f8bbd9023971b2d&scene=19#wechat_redirect'],
 ['【TAB】 Alone',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000438&idx=1&sn=f0f7f06e3d74205efe33e737d54949b9&scene=19#wechat_redirect'],
 ['【TAB】 Boulevard of Broken Dreams - Green Day',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000752&idx=1&sn=d59233636a3b837371072a5f52c63c56&scene=19#wechat_redirect'],
 ['【TAB】 Careless Whisper',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000787&idx=1&sn=3ddbbb2fb900aa568fa064bd2d591f9b&scene=19#wechat_redirect'],
 ['【TAB】 Closer - The Chainsmokers ft. Hasley',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000523&idx=1&sn=d08c2babbd6896e01fec08bc206e4c74&scene=19#wechat_redirect'],
 ['【TAB】 Counting Stars - OneRepublic',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000767&idx=1&sn=6e721cec49116354b92dcf94d52fc07f&scene=19#wechat_redirect'],
 ['【TAB】 Despacito',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000346&idx=1&sn=6ebf599913be9ae040e57ee8d2e5baa3&scene=19#wechat_redirect'],
 ['【TAB】 Galway Girl',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000325&idx=1&sn=34c0a1a05dce4c95d18d8accb3e14688&scene=19#wechat_redirect'],
 ['【TAB】 Havana',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000047&idx=1&sn=774acde2d65e181e38446858a07701b4&scene=19#wechat_redirect'],
 ['【TAB】 Heathens - Twenty One Pilots',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000781&idx=1&sn=a11618e4c29b96ce5d45782f072dd159&scene=19#wechat_redirect'],
 ["【TAB】I'll be there for you",
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100001047&idx=1&sn=b50e7c617a67d261e093b686547b9d2d&scene=19#wechat_redirect'],
 ['【TAB】 Let Her Go - Passenger',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000628&idx=1&sn=bbcac788be592b154ce641dd1334d0bc&scene=19#wechat_redirect'],
 ['【TAB】 Paradise',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000980&idx=1&sn=d9f4ac078068dd5929b5461d0e28eca0&scene=19#wechat_redirect'],
 ['【TAB】 Pumped Up Kicks',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000507&idx=1&sn=98a041bb50c4d0bc2ef13cf0d0f840cc&scene=19#wechat_redirect'],
 ['【TAB】 Revolution',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000838&idx=1&sn=d4441494d379dc357b90b5a4d0eeb7a2&scene=19#wechat_redirect'],
 ['【TAB】 Revolution - Conny Berghäll',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100001032&idx=1&sn=93539f264069a5c8f2541b1a61be38ec&scene=19#wechat_redirect'],
 ['【TAB】 Say Something',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000416&idx=1&sn=c851215af66b003326eb98d5a231fb5a&scene=19#wechat_redirect'],
 ['【TAB】 Santa Claus Is Coming To Town',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000171&idx=1&sn=2b57e57212e49da184fd4421026f5868&scene=19#wechat_redirect'],
 ['【TAB】 斯卡布罗集市',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100001076&idx=1&sn=d034e59df5fc03a6d755e449dbde4e93&scene=19#wechat_redirect'],
 ['【TAB】 Scared To Be Lonely',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000233&idx=1&sn=3aad7d0f03330ff66c58b245f4518af1&scene=19#wechat_redirect'],
 ['【TAB】 See you again - Wiz Kalifa ft. Charlie Puth',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000760&idx=1&sn=5dfaf1e308715da70a10e91365e414c3&scene=19#wechat_redirect'],
 ['【TAB】 Shape Of You',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000452&idx=1&sn=a27970bed8811af502d492c134acfbf9&scene=19#wechat_redirect'],
 ['【TAB】 Shelter',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000257&idx=1&sn=ea9fae6a37f9f32d7bdea064cc25fa92&scene=19#wechat_redirect'],
 ['【TAB】 Something Just Like This',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000478&idx=1&sn=d8112d2cb407c1c2fb24d5abd0a092f7&scene=19#wechat_redirect'],
 ['【TAB】 Stay',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000820&idx=1&sn=508da6311534392ad68fb6388e1b4867&scene=19#wechat_redirect'],
 ['【TAB】 Stay With Me - Sam Smith',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000421&idx=1&sn=5d48968abcfdc5333a363ca000e49ae6&scene=19#wechat_redirect'],
 ['【TAB】 Thank You',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000247&idx=1&sn=4b85e3f2e0aeb5fe9aaa05525e2e916b&scene=19#wechat_redirect'],
 ['【TAB】 Too Good At Goodbyes',
  'http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000316&idx=1&sn=53b569177f7df04e3512f5bc14ed4e9c&scene=19#wechat_redirect']]
```

**爬单个谱子**

先把文章内所有图片都导出来。试试直接解析网页源代码来获取图片：

```python
import selenium
from selenium import webdriver
wd = webdriver.Chrome()
wd.get('http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000229&idx=1&sn=dc36b27899892ec61f8bbd9023971b2d&scene=19#wechat_redirect')

soup = BeautifulSoup(wd.page_source, 'html5lib')
soup.find_all('img')
```

```
[<img alt="" class="profile_avatar" id="js_profile_qrcode_img" src=""/>,
 <img class="" data-copyright="0" data-fail="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4aynvIQ3VB7pVsicpib3PpysXiaWdID3LUKGKVWcUJia0qpJrxqicdMKWsNw/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4aynvIQ3VB7pVsicpib3PpysXiaWdID3LUKGKVWcUJia0qpJrxqicdMKWsNw/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" style="width: auto !important; height: auto !important; visibility: visible !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4sicKIpmomgBGWibGsnG6pVEleXTwjXchzcHTBwvfflNExICCz02FWQOQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4x9LbUxoZWAOX6G4qzf8vJKQ2iatiar08w8t3BP0PHciaiabDclnHUJ5zAg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4ibJoz5GEiaencoKhx8T8vbZ1EzLI2J9tQeRwEskABBbcTia6Sq3YcAnCQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4VTrUiaxyefSkplJsyJrbnEEicRJIMQBGf6bSUUeTc2NjAqf2xicJk9T8w/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4QEW5R0bNPEmibotz4qbH6icE6KCafMzjYZcpwHAQR9MHtYYJH8YpictYg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4dXFVoODNuakuu4JJVIySr1D4cTesXd5GR1HuaeSfOib09S8muBpdmBw/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img class="img_loading" data-copyright="0" data-ratio="1.41484375" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4A59RjLs1WEXFqLiakniaYtWbTfKK3hsiauhSpyv7XzicQna0oicshpFnRQg/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 677px !important; height: 957.849px !important;"/>,
 <img _width="100%" class="img_loading __bg_gif" data-order="0" data-ratio="0.1591696" data-src="https://mmbiz.qpic.cn/mmbiz_gif/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4lqz74a2yFAibDr61n7kBPFwrsWcicuDv9nib8CIKZg9FRZfsXgSa0ibdEg/640?wx_fmt=gif" data-type="gif" data-w="578" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="vertical-align: middle; box-sizing: border-box; width: 609px !important; height: 96.9343px !important;" width="100%"/>,
 <img class="img_loading" data-copyright="0" data-ratio="0.5577689243027888" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/lvZ1HogYhgJo928FIA90vK1dg2wiblJ9ZnI1MI0Sru24fD2j4SKvM8uejwy22rNHOico7UqhicDvvVsibI3Agk0ib3w/640?wx_fmt=png" data-type="png" data-w="502" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 502px !important; height: 280px !important;"/>,
 <img alt="" id="js_preview_reward_author_head" src=""/>,
 <img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/en_US/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534de.png"/>,
 <img class="qr_code_pc_img" id="js_pc_qr_code_img" src="/mp/qrcode?scene=10000004&amp;size=102&amp;__biz=MzUxOTY3NDYzNQ==&amp;mid=100000229&amp;idx=1&amp;sn=dc36b27899892ec61f8bbd9023971b2d&amp;send_time="/>,
 <img id="js_pc_weapp_code_img"/>]
```

可以发现有好多尚未加载的图片。用键盘把页码滑到最下面。

```
from selenium.webdriver.common.keys import Keys
mainelem = wd.find_element_by_tag_name('html')
mainelem.send_keys(Keys.PAGE_DOWN)
```

看着页面自动往下翻，想起黑客帝国一开头Neo爬报纸找莫菲思的画面，一模一样。

但是实际上没有必要。`<img>`里有一个data-src，就是图片链接。

接着问题来了：怎么区分乐谱图和其他图片呢？最简单的思路是训练一个
神经网络（笑）。注意到文章内的图片有一个特别的属性data-src，似乎指向
图片地址。

```python
def get_img(lnk):
    wd.get(lnk)
    soup = BeautifulSoup(wd.page_source, 'html5lib')
    out = []

    for img in soup.find_all('img'):
        if 'data-src' in img.attrs:
            out.append(img['data-src'])

    return out

get_img('http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000316&idx=1&sn=53b569177f7df04e3512f5bc14ed4e9c&scene=19#wechat_redirect')
```

```
['https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPXKD4kN8ic4VTriapU6m62vOBNJAMOHSwT62GV7GLEaa4ca0ibUvalYUMg/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLP6utZFmMnll2M8UtCxoHn5rUV7Nlq3xEZGpXKHiaVyATcfnScmQhw7TA/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPd6XAlAqYkrGKhZXdr4V7UWYN9van5vlz0RFhYLlWHICHFVatISaw4A/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPmOpglZ4wh5ZVTd33RlbxribtQFNJNDRr6t4aUobLeRFd7S3cUpeDRaA/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_gif/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLP4RlQLnWEF2ntIfBP4XQMR7zuwHTD6O9NNib6dPj7reCmrpsDhs7ufWA/640?wx_fmt=gif',
 'https://mmbiz.qpic.cn/mmbiz_png/lvZ1HogYhgJo928FIA90vK1dg2wiblJ9ZnI1MI0Sru24fD2j4SKvM8uejwy22rNHOico7UqhicDvvVsibI3Agk0ib3w/640?wx_fmt=png']
```

注意到所有乐谱都是jpg。用这个特性过滤：

```python
def get_img(lnk):
    wd.get(lnk)
    soup = BeautifulSoup(wd.page_source, 'html5lib')
    out = []

    for img in soup.find_all('img'):
        if 'data-src' in img.attrs:
            imglnk = img['data-src']
            if imglnk.endswith('jpeg'):
                out.append(imglnk)

    return out

get_img('http://mp.weixin.qq.com/s?__biz=MzUxOTY3NDYzNQ==&mid=100000316&idx=1&sn=53b569177f7df04e3512f5bc14ed4e9c&scene=19#wechat_redirect')
```

```
['https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPXKD4kN8ic4VTriapU6m62vOBNJAMOHSwT62GV7GLEaa4ca0ibUvalYUMg/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLP6utZFmMnll2M8UtCxoHn5rUV7Nlq3xEZGpXKHiaVyATcfnScmQhw7TA/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPd6XAlAqYkrGKhZXdr4V7UWYN9van5vlz0RFhYLlWHICHFVatISaw4A/640?wx_fmt=jpeg',
 'https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPmOpglZ4wh5ZVTd33RlbxribtQFNJNDRr6t4aUobLeRFd7S3cUpeDRaA/640?wx_fmt=jpeg']
```

很好。再拿一个链接试试，可以。开始批量爬：

```python
import os
import time
import sys
import selenium
from selenium import webdriver
from bs4 import BeautifulSoup
wd = webdriver.Chrome()

def get_img(lnk):
    wd.get(lnk)
    soup = BeautifulSoup(wd.page_source, 'html5lib')
    out = []

    for img in soup.find_all('img'):
        if 'data-src' in img.attrs:
            imglnk = img['data-src']
            if imglnk.endswith('jpeg'):
                out.append(imglnk)

    return out

for [name, lnk] in dat:
    print(name)
    os.mkdir(name)
    os.chdir(name)
    imgs = get_img(lnk)

    for no, imgsrc in enumerate(imgs):
        cmd = 'wget "{}" -O {}.jpg'.format(imgsrc, no)
        print(cmd)
        os.system(cmd)
        time.sleep(1)

    os.chdir('..')
```

```
【TAB】 All Falls Down
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4aynvIQ3VB7pVsicpib3PpysXiaWdID3LUKGKVWcUJia0qpJrxqicdMKWsNw/640?wx_fmt=jpeg" -O 0.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4sicKIpmomgBGWibGsnG6pVEleXTwjXchzcHTBwvfflNExICCz02FWQOQ/640?wx_fmt=jpeg" -O 1.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4x9LbUxoZWAOX6G4qzf8vJKQ2iatiar08w8t3BP0PHciaiabDclnHUJ5zAg/640?wx_fmt=jpeg" -O 2.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4ibJoz5GEiaencoKhx8T8vbZ1EzLI2J9tQeRwEskABBbcTia6Sq3YcAnCQ/640?wx_fmt=jpeg" -O 3.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4VTrUiaxyefSkplJsyJrbnEEicRJIMQBGf6bSUUeTc2NjAqf2xicJk9T8w/640?wx_fmt=jpeg" -O 4.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4QEW5R0bNPEmibotz4qbH6icE6KCafMzjYZcpwHAQR9MHtYYJH8YpictYg/640?wx_fmt=jpeg" -O 5.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4dXFVoODNuakuu4JJVIySr1D4cTesXd5GR1HuaeSfOib09S8muBpdmBw/640?wx_fmt=jpeg" -O 6.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIdcbBTVV18OkCG4GH4QLx4A59RjLs1WEXFqLiakniaYtWbTfKK3hsiauhSpyv7XzicQna0oicshpFnRQg/640?wx_fmt=jpeg" -O 7.jpg
【TAB】 Alone
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPdcA56Kd4siak1pOe15Kl7e5icq6pEXEiaiaW458yvq0O3iccCzIBEBic6LhQ/640?wx_fmt=jpeg" -O 0.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPxK9Em7zwrI0hdFkmzkuORmeu0ZJxJ7iblybCKFUKV0ZPiclky9Psx1GA/640?wx_fmt=jpeg" -O 1.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLPHicYP9TnePGAfhmzELKicm14iaFyY8rzngocHNaox1aA9jbWQDfDmyaXA/640?wx_fmt=jpeg" -O 2.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgJXRpCDKSPxq2Ml0shgTQLP6yzTWBjqaXVGCGC6d5ticdScIHwvaFHqllUorviaxjqkoy2xgichdnafg/640?wx_fmt=jpeg" -O 3.jpg
【TAB】 Boulevard of Broken Dreams - Green Day
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykaqJ0oF8ev2icja0TVqxsot6QutqLDTqaDHPnHJzYy2wAwkd7nFDhzhWA/640?wx_fmt=jpeg" -O 0.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykat4nyW0v8BeLZfUT7SMic6blLkjjEDPvnuyqicguQYd1trYKOBvy2kfFg/640?wx_fmt=jpeg" -O 1.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykaFhLkSqylAoKPiaiaDEYpMr63kQusbxiaNyFr2Ivbicp6CNmiaDxx6cA8A7w/640?wx_fmt=jpeg" -O 2.jpg
【TAB】 Careless Whisper
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykaFgiaKUQjHTGxZvK5vyNHPVeOC6MGszHaRuDCCvuIzabUtjw7xrh33zQ/640?wx_fmt=jpeg" -O 0.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykamEayxOPm2FQvJhpfLbWThic40piaAcnG1O60AzibpKubn5PJOxmfiaibZow/640?wx_fmt=jpeg" -O 1.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5ykacSdd85aQicq5fYwVADYe32rEqia7gmAQB4UrLKM8sfDmD3k0JVY1dVjg/640?wx_fmt=jpeg" -O 2.jpg
【TAB】 Closer - The Chainsmokers ft. Hasley
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3TcDhAD7fWsTXSqQvQIQwWqjZB9c0C4O1htHeqK7LZzV6goPZcLKXu5nw/640?wx_fmt=jpeg" -O 0.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3Tcn4Zicupwia8t1tQeWAv8DtwkuicN81Q98YzzdhDiblcz1hjpbVN0U9fjZQ/640?wx_fmt=jpeg" -O 1.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3TcT3mn6ByMQrcQJwzvug1Rxu5VExqRVX9qVZHicNDo7vCyAQJg7pwRSog/640?wx_fmt=jpeg" -O 2.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3TcIUH8NE4U92g4Z2z57CkmbkNFLZ0Nd3ING2yib2sibL3pszTu8pcfLVNQ/640?wx_fmt=jpeg" -O 3.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgKibnw9HVdMdjHh3YnsOk3TcfUvUuzMDjoqibAhMlxFx4L47ZIicPOB5ibVSLxzIrIjN9pUass3oD7tVg/640?wx_fmt=jpeg" -O 4.jpg
【TAB】 Counting Stars - OneRepublic
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5yka8rPgQNmCVzkAic6NhBaUvRaa3JamgnomqctibNRLgLFZ7kUXz13z1P5A/640?wx_fmt=jpeg" -O 0.jpg
wget "https://mmbiz.qpic.cn/mmbiz_jpg/lvZ1HogYhgIjvmGdYibhOibbNOTQiap5yka1ShaNlXjPcKyfa78GTk4YWefJiaH3eTTN09EjN7p89USFaTSjQZdxuQ/640?wx_fmt=jpeg" -O 1.jpg
...
```

这样就搞定了。用同样的方法也能把目录也爬下来。
